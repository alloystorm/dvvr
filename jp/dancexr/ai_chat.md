---
layout: single
title: AIパワードボイスチャット
toc: true
sidebar:
  nav: "docs-jp"
---

[Eng](/dancexr/ai_chat) | [繁中](/tw/dancexr/ai_chat) | [日本語](/jp/dancexr/ai_chat) | [한국어](/kr/dancexr/ai_chat) | [简中](/zh/dancexr/ai_chat)

## AIパワードボイスチャット

### 主な特徴
* OpenAI、ローカルまたはリモートのテキスト生成WebUIを使用するオプション
* AIが生成したメッセージを音声に変換するための組み込みTTSエンジン
* トーク中にキャラクターの顔を自動的にアニメーションさせる組み込みリップシンク
* 音声をテキストに変換してAIに送信するための組み込み音声認識
* 選択できる900以上の英語の声が含まれており、各キャラクターに独自の声を設定できます

### 制限事項
* 音声エンジンはWindowsのみです。他のプラットフォームでは音声認識を使用して話すことはできますが、応答はテキストのみになります。
## ## AIサービス
キャラクターに知能を与えるために使用できるさまざまなAIサービスのオプションがあります。以下ではそれぞれのオプションの利点と欠点について説明します。

### OpenAI（ChatGPT）
現時点で最も知能の高いオプションです。

**利点：**
* スマート
* 速い
* 他のリモートオプションと比較してコスト効果がある

**欠点：**
* 検閲がある

**セットアップ：**
DanceXRでOpenAIサービスを使用するには、OpenAI APIキーが必要です。
* OpenAIアカウントに登録してログインします。
* ページの右上隅にあるプロファイルアイコンをクリックします。
* 「APIキーの表示」を選択してAPIページを開きます。
* 「新しいシークレットキーの作成」をクリックし、表示されたらキーをコピーします。キーは**ここでのみ表示される**ため、後でフルキーを取得することはできませんので、紛失しないように注意してください。
* DanceXRを開き、チャットメニューからConfigアイコンをクリックします。
* AIサービスに移動し、「OpenAI APIキー」ボックスにキーを貼り付けます。
* 次に、「AIサービス」ドロップダウンで「OpenAI（ChatGPT）」を選択し、設定が完了します。

### OobaBoogaテキスト生成WebUI
このオプションでは、パソコンの性能が十分に高い場合にローカルで大規模な言語モデル（LLM）を実行することができます。7bモデルまたは13bモデルがチャットには十分です。

**利点：**
* プライバシーが保たれ、何も送信されず、すべてがローカルで行われます。
* NSFWコンテンツに対して検閲のないモデルを使用することができます。
* 無料

**欠点：**
* OpenAIモデルほどスマートではありません
* 少しセットアップが必要です
* VRAMが十分でない場合に非常に遅くなることがあります。特にDanceXRを同時に実行している場合、システムはLLMを仮想VRAMに押し込んでパフォーマンスを低下させる可能性があります。

**セットアップ：**
* こちらの手順に従ってダウンロードしてインストールします：https://github.com/oobabooga/text-generation-webui
* WebUIをDanceXRで使用するためには、APIをオンにする必要があります。これを行うには、CMD_FLAGS.txtファイルを開き、そこに「--listen --api」と追加し、それを再起動します。
* 実行中に、モデルタブに移動してモデルをダウンロードします（すでに持っていない場合）。
* 以下の2つのモデルのいずれかを使用することをおすすめします：https://huggingface.co/TheBloke/Luna-AI-Llama2-Uncensored-GPTQ（7b、実行が容易）https://huggingface.co/TheBloke/Nous-Hermes-Llama2-GPTQ（13b、よりスマート）
* モデルリストを更新してロードします。
* DanceXRで、「AIサービス」→「Select Service」から「Local WebUI」を選択します。
* デフォルトのURL（http://127.0.0.1:5000）は、セットアップによって異なるポートやURLが必要な場合を除いて動作するはずです。

### Runpodのようなリモートサービスを使用してWebUIを実行する
GPUを借りてAIモデルを実行することができるサービスがあります。Runpodはその1つです。WebUIのテンプレートが用意されており、ローカルで実行するよりもセットアップが簡単です。

**利点：**
* 速くて簡単
* ローカルのGPUでは実行不可能なモデルを自由に選択できます。

**欠点：**
* OpenAIよりもやや高価です
* 実行するたびにモデルをダウンロードする必要があります。ただし、数分で完了するはずです。

**セットアップ：**
* 「Community Cloud」からGPUを選択し、「Deploy」をクリックします。3080tiは13bモデルを実行するのに十分です。それは1時間あたり26セントかかります。
* テンプレートのドロップダウンから「RunPod TheBloke LLMs」を選択します。
* 実行中に、接続をクリックすると、WebUIとAPIのリンクが表示されますので、APIのURLをコピーしてDanceXRの「Remote WebUI URL」ボックスに貼り付けます。
* WebUIのリンクをクリックして、モデルタブに移動してモデルをダウンロードします。
* 以下の2つのモデルのいずれかを使用することをおすすめします：https://huggingface.co/TheBloke/Luna-AI-Llama2-Uncensored-GPTQ（7b、実行が容易）https://huggingface.co/TheBloke/Nous-Hermes-Llama2-GPTQ（13b、よりスマート）
* モデルリストを更新してロードします。
## ## チャットコントロール

### テンプレート
テンプレートは、AIモデルが各キャラクターのチャットメッセージを生成するためのものです。複雑に思えるかもしれませんが、実際には非常にシンプルです。chat/templatesフォルダを開くと、デフォルトのテンプレートを開いて動作を確認することができます。

基本的には、プレーンテキストであなたに特定のことを行うように指示することです。デフォルトのテンプレートを変更して別の名前で保存し、チャットの内容にどのように影響するかを確認することができます。たとえば、環境の説明を追加してチャットのシナリオを設定することができます。

DanceXRでは、チャット設定->テンプレートに移動して作成したテンプレートを選択します。


### キャラクター
キャラクターは、俳優モデルの名前から派生しています。たとえば、「小春 ブーケ カトレア ヘア B サイドポニーテール」という場合、「小春」がキャラクター名として解釈され、残りの「ブーケ カトレア ヘア B サイドポニーテール」は彼女の衣装の説明として使用されます。

言語モデルは、よく知られている場合、キャラクターについていくつかの知識を持っているかもしれません。したがって、特にOpenAIを使用する場合、彼らが誰であり、どのように振る舞うかを知っていることがあります。

キャラクター設定では、キャラクターの説明と性格を入力することができます。これは、彼らがチャットでどのように振る舞うかに大きく影響します。たとえば、誇り高く傲慢なキャラクターを「従順で喜んで協力する」と表現することで、彼らの性格を変えることができます。

「Player」も技術的にはキャラクターです。自分自身についての名前、説明、性格を変更して、自分が好きな人物になることができます。


### パーソナ
キャラクター設定には、パーソナのドロップダウンもあります。これにより、TavernAIなどのAIロールプレイプログラムからダウンロードしたキャラクターを使用することができます。これらは通常、PNG形式で提供されます。png画像のメタデータには、キャラクターの説明が含まれています。

このオンラインキャラクターエディタを使用して、pngキャラクターをjson形式に変換します。https://zoltanai.github.io/character-editor/

次に、jsonを「chat/personas」フォルダに配置すると、キャラクター設定のパーソナのドロップダウンに表示されます。これを行った後、パーソナの説明がキャラクターの説明を上書きします。


### チャット履歴
チャット履歴は、新しいコンテンツを生成するたびにAIに送信され、コンテキストを維持するために使用されます。異なるシナリオやトピックに切り替えたい場合は、まず履歴をクリアして、AIが以前のチャットコンテキストに影響を受けないようにします。これを使用して、環境を操作し、チャットを進めることもできます。メッセージで何かが起こったと説明する場合、AIはそのコンテキストで続けます。

ただし、プロンプトの制限に達すると、最も古いメッセージは無視され、コンテキストに含まれません。したがって、AIは履歴の中であまりにも遠いものを忘れる可能性があります。

チャットインターフェースでは、チャットメッセージの横にあるアイコンをクリックしてチャット履歴を操作することができます。オプションには次のものがあります。

* 再生成：以下のすべてのメッセージを削除し、AIにこのメッセージを再生成させる
* 書き直し：メッセージを引き継いで自分で書き直す。これを行う場合、メッセージの前に名前とコロンを保持する必要があります。そうしないと、システムはこのメッセージが誰からのものかわかりません。
* リプレイ：このメッセージからチャット履歴を再生する
* エントリの削除：このメッセージを削除する
* 上記を削除：これより上のすべてのメッセージを削除する
* 以下を削除：これより下のすべてのメッセージを削除する


### 温度
この値は、AIモデルがチャットメッセージを生成する際の自由度を制御します。画像生成と同様に、同じ入力でも生成結果はわずかに異なる場合があり、温度はその変動範囲を制御します。


### プレゼンスペナルティと頻度ペナルティ
これらの値を増やすと、AIが繰り返しコンテンツを生成する確率が低くなります。


### 最大生成トークン数と最大プロンプト長
LLMにはトークンの制限があり、この制限を超えるコンテンツは正しく生成されません。


### 自動生成とプレーヤーのための生成
「次のメッセージを自動生成」をオンにすると、タイマーが終了したときにAIが自動的に次のメッセージを生成できるようになります。

「プレーヤーのために生成」をオンにすると、AIがプレーヤーのためにメッセージを生成できるようになります。
## ## テキスト読み上げ

### 追加の声
DanceXRはPiperというTTSエンジンを使用しています。ここでは、DanceXRで使用するための追加の音声モデルを聞くことができます。

https://rhasspy.github.io/piper-samples/

ダウンロードしたら、それらをchat\voices\piperフォルダに入れてください。onnxファイルとonnx.jsonファイルの両方が必要です。

### 音声マネージャー
組み込みの音声モデルには900以上の異なる声が含まれています。デフォルトでは、そのうちの最初の20個のみが有効になっています。ユーザーが選択できる声が900もあるため、他の声を有効にするには、チャットの設定から音声→音声マネージャーに移動し、リストから声を選択し、それを聞いてから「選択済み」にチェックを入れて、音声リストに追加できるようにします。

システム、プレイヤー、および各キャラクターに異なる声を選択することができます。

### 言語の一致とフォールバック
AIモデルは異なる言語のメッセージを生成することができますが、音声モデルはできません。DanceXRはメッセージの言語を判別しようとしますが、選択した音声の言語と一致しない場合、音声設定で「フォールバック」を有効にすると、音声リスト内の言語に一致する別の音声を選択することができます。

## 音声からテキストへ

組み込みのWhisperモデルは、音声をテキストに変換してAIに送信することができます。手動モードと自動モードの2つのモードがあります。

### 手動モード
手動モードでは、マイクボタンをクリックすると録音が開始され、終了したら再度クリックしてオーディオが処理され、結果がAIに送信されます。

### 自動モード
自動モードでは、チャットがアイドル状態（キャラクターが話していない状態）のときに自動的に録音が開始され、オーディオがリアルタイムで処理され、話し終わったら送信されます。ただし、時にはあまりスマートではありません。

低スペックのデバイスでは、オーディオをテキストに変換するのに時間がかかる場合があります。そのため、Android、Quest、Picoには自動モードはおすすめできません。

### キーバインディング
入力設定で、マイクの状態を切り替えるためのボタンを割り当てることができます。これにより、UIに入らずに録音を制御することができます。デフォルトでは、右手コントローラーのメニューボタンに割り当てられています。

## 設定とキャラクター設定のリセット
すべてはコンテンツライブラリのchatフォルダに保存されています。すべてをデフォルトにリセットするために、chatフォルダを削除しても構いません。
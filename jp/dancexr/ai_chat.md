---
layout: single
title: AI パワードボイスチャット
toc: true
locale: ja-JP
sidebar:
  nav: "docs-jp"
---

## AI パワードボイスチャット

### 主な特徴
* OpenAI、ローカルまたはリモートのテキスト生成 WebUI を AI サービスとして使用するオプション
* AI 生成メッセージを音声に変換するための組み込み TTS エンジン
* トーク中にキャラクターの顔を自動的にアニメーションさせる組み込みリップシンク機能
* 音声をテキストに変換して AI に送信するための組み込み音声認識
* 選択可能な英語の声が900以上含まれており、各キャラクターには独自の声を設定できます

### 制限事項
* 音声エンジンは Windows のみです。他のプラットフォームでは音声認識を使用して話すことはできますが、返答はテキストのみとなります。
## ## AIサービス
キャラクターに知性を持たせるために使用できるAIサービスのさまざまなオプションがあります。以下では各オプションの利点と欠点について議論します。

### OpenAI（ChatGPT）
現時点では最も知能のあるオプションです。

**利点：**
* スマート
* 早い
* 他のリモートオプションと比較してコスト効果が高い

**欠点：**
* 検閲される

**設定：**
DanceXRでOpenAIサービスを使用するには、OpenAIのAPIキーが必要です。
* OpenAIアカウントに登録し、ログインします。
* ページの右上隅にあるプロファイルアイコンをクリックします。
* "APIキーの表示"を選択してAPIページを開きます。
* "新しいシークレットキーを作成"をクリックし、表示されたらキーをコピーします。キーは**ここで一度だけ表示**されるため、後でフルキーを取得することはできませんので、失くさないように注意してください。
* DanceXRを開き、チャットメニューからConfigアイコンをクリックします。
* AIサービスに移動し、"OpenAI APIキー"ボックスにキーを貼り付けます。
* 次に、"AIサービス"ドロップダウンで"OpenAI (ChatGPT)"を選択し、設定が完了します。

### OobaBoogaテキスト生成WebUI
このオプションを使用すると、PCの性能が十分に高い場合には、大規模な言語モデル（LLM）をローカルで実行できます。7bまたは13bモデルはチャットに十分な性能を発揮します。

**利点：**
* プライバシーが守られ、何も送信されず、すべてがローカルで処理されます。
* NSFWコンテンツに対して検閲されていないモデルを使用できます。
* 無料

**欠点：**
* OpenAIモデルほどスマートではありません。
* 少しの設定が必要です。
* 十分なVRAMがない場合、非常に遅くなることがあります。特にDanceXRを同時に実行している場合、システムはLLMを仮想VRAMに押しやるため、パフォーマンスが低下します。

**設定：**
* こちらの手順に従ってダウンロードしてインストールします：https://github.com/oobabooga/text-generation-webui
* WebUIをDanceXRで動作させるためには、APIを有効にする必要があります。これを行うには、CMD_FLAGS.txtファイルを開き、「--listen --api」と追加し、その後再起動します。
* 実行中であれば、モデルタブに移動し、既に所持していない場合はモデルをダウンロードします。
* 以下の2つのモデルのいずれかを使用することをお勧めします：https://huggingface.co/TheBloke/Luna-AI-Llama2-Uncensored-GPTQ（7b、実行が容易） https://huggingface.co/TheBloke/Nous-Hermes-Llama2-GPTQ（13b、よりスマート）
* モデルリストを更新し、ロードします。
* DanceXRでは、AIサービス->サービスの選択から「Local WebUI」を選択します。
* デフォルトのURL（http://127.0.0.1:5000）は、セットアップによって異なるポートやURLが必要な場合を除いて機能するはずです。

### Runpodのようなリモートサービスを使用してWebUIを実行する
GPUを借りてAIモデルを実行できるサービスがあります。Runpodはその1つです。彼らはWebUIのためのテンプレートを提供しており、ローカルで実行するよりも簡単に設定できます。

**利点：**
* 速くて簡単
* ローカルのGPUでは実行できないモデルを自由に選択できます。

**欠点：**
* OpenAIよりもやや高価
* 実行するたびにモデルをダウンロードする必要があります。しかし、数分で完了します。

**設定：**
* "Community Cloud"からGPUを選択し、「Deploy」をクリックします。3080tiは13bモデルを実行するのに十分な性能を持っています。それには1時間あたり26セントかかります。
* テンプレートのドロップダウンから「RunPod TheBloke LLMs」を選択します。
* 実行中であれば、接続をクリックすると、WebUIとAPIのリンクが表示されますので、APIのURLをコピーしてDanceXRの「Remote WebUI URL」ボックスに貼り付けます。
* WebUIのリンクをクリックし、モデルタブに移動してモデルをダウンロードします。
* 以下の2つのモデルのいずれかを使用することをお勧めします：https://huggingface.co/TheBloke/Luna-AI-Llama2-Uncensored-GPTQ（7b、実行が容易） https://huggingface.co/TheBloke/Nous-Hermes-Llama2-GPTQ（13b、よりスマート）
* モデルリストを更新し、ロードします。
## ## チャットコントロール

### テンプレート
テンプレートはAIモデルが各キャラクターのチャットメッセージを生成するためのものです。複雑に思えるかもしれませんが、実際は非常にシンプルです。chat/templatesフォルダを開くと、デフォルトのテンプレートを確認できます。

基本的には、プレーンテキストで特定のことを他の人に頼むようなものです。デフォルトのテンプレートを変更して別の名前で保存すると、チャットの内容にどのように影響するかを確認できます。例えば、環境の説明を追加してチャットのシナリオを設定することができます。

DanceXRでは、チャット設定->テンプレートに移動して、作成したテンプレートを選択します。

### キャラクター
キャラクターは、俳優モデルの名前から派生しています。例えば、「小春 ブーケ カトレア ヘア B サイドポニーテール」という場合、「小春」がキャラクター名として解釈され、残りの「ブーケ カトレア ヘア B サイドポニーテール」は彼女の衣装の説明として使用されます。

キャラクターが有名な場合、言語モデルはキャラクターについていくつかの知識を持っているかもしれませんので、OpenAIを使用する場合は、彼らが誰であり、どのように振る舞うかを知っていることがあります。

キャラクター設定では、キャラクターの説明や性格を入力することができます。これは、彼らがチャットでどのように振る舞うかに大きな影響を与えます。例えば、誇り高く傲慢なキャラクターを「おとなしく従順」と表現することで、彼らの性格を変えることができます。

「Player」も実際にはキャラクターです。自分自身のために名前、説明、性格を変えて、好きなキャラクターになることができます。

### ペルソナ
キャラクター設定には、ペルソナのドロップダウンもあります。これにより、TavernAIなどのAIロールプレイプログラムからダウンロードしたキャラクターを使用することができます。これらは通常、PNG形式で提供されます。PNG画像のメタデータには、キャラクターの説明が含まれています。

このオンラインキャラクターエディタを使用して、PNGキャラクターをJSON形式に変換します。https://zoltanai.github.io/character-editor/

その後、JSONファイルを「chat/personas」フォルダに配置すると、キャラクター設定のペルソナのドロップダウンに表示されます。これを行った後は、ペルソナの説明がキャラクターの説明を上書きします。

### チャット履歴
新しいコンテンツを生成するたびに、チャット履歴がAIに送信され、コンテキストが維持されます。異なるシナリオやトピックに切り替えたい場合は、まず履歴をクリアして、AIが以前のチャットコンテキストに影響を受けないようにします。これを使用して環境を操作し、チャットを進めることもできます。メッセージで何かが起こったことを説明する場合、AIはそのコンテキストを続けるでしょう。

ただし、プロンプトの制限に達すると、最も古いメッセージは無視され、コンテキストに含まれません。したがって、AIは履歴の中にあまりにも過去にあることを忘れるかもしれません。

チャットインターフェースでは、チャットメッセージの横にあるアイコンをクリックしてチャット履歴を操作できます。オプションには次のものがあります。

- 再生成：下のすべてのメッセージを削除し、AIにこのメッセージを再生成させる
- 書き直し：メッセージを引き継いで自分で書き直す。これを行う際は、メッセージの前に名前とコロンを保持する必要があります。そうしないと、システムはこのメッセージの送信元がわかりません。
- リプレイ：このメッセージからチャット履歴を再生する
- エントリの削除：このメッセージを削除する
- 上を削除：このメッセージより上のすべてのメッセージを削除する
- 下を削除：このメッセージより下のすべてのメッセージを削除する

### 温度
この値は、AIモデルがチャットメッセージを生成する際の自由度を制御します。画像生成と同様に、同じ入力でも生成結果はわずかに異なる場合があり、温度はそのばらつきを制御します。

### プレゼンスペナルティと頻度ペナルティ
これらの値を増やすと、AIが繰り返しのコンテンツを生成する可能性が低くなります。

### 最大生成トークン数と最大プロンプト長
LLMsにはトークンの制限があり、この制限を超えるコンテンツは正しく生成されません。

### 自動生成とプレイヤーのための生成
「次のメッセージを自動生成する」をオンにすると、タイマーが終了したときにAIが自動的に次のメッセージを生成することができます。

「プレイヤーのために生成する」をオンにすると、AIがプレイヤーのためにメッセージを生成できるようになります。
## ## テキスト読み上げ

### 追加の声
DanceXRでは、PiperというTTSエンジンを使用しています。ここで、DanceXRで使用するための追加の音声モデルを聞くことができます。

https://rhasspy.github.io/piper-samples/

ダウンロードしたら、それらをchat\voices\piperフォルダに入れてください。onnxファイルとonnx.jsonファイルの両方が必要であることに注意してください。

### 声の管理
組み込みの音声モデルには900以上の異なる声が含まれています。デフォルトでは最初の20個のみが有効になっています。900個はユーザーが選ぶには多すぎるため、他の声を有効にするには、チャットの設定から音声→音声マネージャーに移動し、リストから声を選び、それを聞いてから「選択済み」にチェックを入れて声リストに追加する必要があります。

システム、プレイヤー、および各キャラクターには異なる声を選ぶことができます。

### 言語の一致とフォールバック
AIモデルはさまざまな言語のメッセージを生成することができますが、音声モデルはできません。DanceXRはメッセージの言語を判断しようとしますが、選択された音声の言語と一致しない場合、音声設定で「フォールバック」を有効にすることで、言語に一致する別の音声を選択できるようになります。

## 音声からテキストへの変換

組み込みのWhisperモデルは、音声をテキストに変換してAIに送信することができます。2つのモード、マニュアルモードと自動モードがあります。

### マニュアルモード
マニュアルモードでは、マイクのボタンをクリックすると録音が開始され、終了したら再度クリックするとオーディオが処理され、結果がAIに送信されます。

### 自動モード
自動モードでは、チャットがアイドル状態（キャラクターが話していない状態）のときに自動的に録音が開始され、オンザフライでオーディオが処理され、話し終わったら送信されます。ただし、時にはあまりスマートではありません。

低スペックなデバイスでは、オーディオをテキストに変換するのに時間がかかる場合があります。そのため、Android、Quest、およびPicoでは自動モードはお勧めしません。

### キーバインディング
入力設定で、マイクの状態を切り替えるボタンを割り当てることができますので、UIに入らずに録音を制御することができます。デフォルトでは、右手コントローラのメニューボタンに割り当てられています。

## 設定とキャラクターのリセット
すべての設定は、コンテンツライブラリのchatフォルダに保存されます。デフォルトにリセットするためには、chatフォルダを削除しても構いません。